<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <title>ImageryLayer - raster function | Sample | ArcGIS Maps SDK for JavaScript</title>

    <link rel="stylesheet" href="https://js.arcgis.com/4.34/esri/themes/light/main.css" />
    <script src="https://js.arcgis.com/4.34/"></script>

    <style>
        html,
        body,
        #viewDiv {
            height: 100%;
            margin: 0;
        }
    </style>

    <script type="module">
        const [Map, MapView, ImageryLayer, RasterFunction, MosaicRule, Legend] = await $arcgis.import([
            "@arcgis/core/Map.js",
            "@arcgis/core/views/MapView.js",
            "@arcgis/core/layers/ImageryLayer.js",
            "@arcgis/core/layers/support/RasterFunction.js",
            "@arcgis/core/layers/support/MosaicRule.js",
            "@arcgis/core/widgets/Legend.js"
        ]);

        /**************************************************************************
         * Create image layer with client defined rendering rules and mosaic rules
         *************************************************************************/

        // Defines a Remap raster function. Remap reclassifies pixel
        // values to new values. In this case we want to separate
        // two landcover types: forested areas and non-forested areas
        const remapRF = new RasterFunction({
            functionName: "Remap",
            functionArguments: {
                // pixel values of forest categories are 41, 42, and 43
                // according to the  raster attribute table.
                // The InputRanges property defines the ranges of intial pixel values to remap
                // Three ranges: [0, 41], [41, 44], and [44, 255] are defined to extract forest pixels.
                inputRanges: [0, 41, 41, 44, 44, 255],
                // non-forest pixels (0-41 and 44-255) are remapped to a value of 1,
                // forest pixels (41-44) are remapped to a value of 2.
                outputValues: [1, 2, 3],
                // $$(default) refers to the entire image service,
                // $2 refers to the second image of the image service
                raster: "$$",
            },
        });
        
        // Define a class breaks renderer to colorize the remapped pixel values
        const classBreaksRenderer = {
        type: "class-breaks",
        field: "Value",
        classBreakInfos: [
            {
            minValue: 0.5,
            maxValue: 1.5,
            label: "Non-forest",
            symbol: { type: "simple-fill", color: [253, 254, 152, 180] }
            },
            {
            minValue: 1.5,
            maxValue: 2.5,
            label: "Forest",
            symbol: { type: "simple-fill", color: [2, 102, 6, 180] }
            },
            {
            minValue: 2.5,
            maxValue: 3.5,
            label: "Other",
            symbol: { type: "simple-fill", color: [255, 0, 6, 180] }
            }
        ]
        };

        const layer = new ImageryLayer({
            url: "https://sampleserver6.arcgisonline.com/arcgis/rest/services/NLCDLandCover2001/ImageServer",
            // apply the most recent raster function to the chain
            rasterFunction: remapRF,
            renderer: classBreaksRenderer
        });

        /*************************
         * Add image layer to map
         ************************/

        const map = new Map({
            basemap: "gray-vector",
            layers: [layer],
        });

        const view = new MapView({
            container: "viewDiv",
            map: map,
            center: [-84.1522, 35.793],
            zoom: 8,
        });

        let legend = new Legend({
            view: view,
            layerInfos: [{
                layer: layer,
                title: "Lslslslsls individual title"
            }]
        });

        view.ui.add(legend, "bottom-right");
    </script>
</head>

<body>
    <div id="viewDiv"></div>
</body>

</html>